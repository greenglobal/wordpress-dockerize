FROM richarvey/nginx-php-fpm:latest

ENV WEBROOT /var/www/html
ENV GIT_REPO git@bitbucket.org:toancauxanh/gg-web-live.git
ENV GIT_BRANCH develop
ENV GIT_EMAIL binhqd@greenglobal.vn
ENV GIT_NAME binhqdgreenglobal
ENV SSH_KEY LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlKS1FJQkFBS0NBZ0VB MUIvNUNxdzAvVnhGTEE3TUt2OVQrcDBtN3JaOHordDRqTXJZUS9XTzExaFFrYzNI CmMyV0wyS1dRUGo4R3U0REtBYTAxd0ZURnh3VkgyZDVGMGJZR3JOUkl3NGpoU1Y1 TjdLWk5mZ0NlcVBNeVhMTTUKcERZbUQ3R05EVnN4YmVnOFFLMzNoNUEwVWthRkFy WS8wWkFwTTZnL2c2cXdtODkrQ2FMaU0rZ1p5TXdpRW1qRAo3cGdGdCswMDFyNTdO Sk9rbDBDdXVva0Y2U3dkWjYyNEtSQkgrdDM0cU5HdCtIbHR4NXVSdjZySU9lOTNw eEc5CkVFM2Nyck9XQVZ4dGlTZ0pNWkQxbmJsblByNU9zbWYrNmVnbDRuQ0NPYmtB aEU3NExwcjl5ZFlvK3UxT0YvR1UKclZ1c3RwTEVkRDBQWHA0VGRjRE1sRUN4T1VX OXNFc2U4TG5qdnZsSDA3Sk9qQllwaGszWndkRzRhTVVIN1BKdwpGTEVJYzVnK1ZD NlJWL2pZZ3pZRGF4YXRTa0NiV21YUnh6STAxd1JFMFdjRlBMNkJvc3hTUk1JSDgz b2JmQ3lXCjlXcDhiZllzNVN0anExSWU4bFRDN3lSVUl0czBuMXY2aHBSbEp3bi9Q dXZPdWErdGczc1I0dXEwOW5kMHVqVGQKNU5nSHdoZkFWWWJCVzFsZFZTbytjNWYr aTRSbkhQbVRUOWNFM0sxMXNqZ3Brd1ErSVkyQUtmL1A4akduQnNTbgppdEttdldG cGRsdCtYWVYzRGEwR0Zpak01RzVxOWg2NjVNcmx6T0p5T3RxbjN1R2Vpcnl3VHZ6 VW9QZXJCQ0pHCjdzOTNqeTVON3BhVG85MGk2aVA5aG1ObXRxQmhTc29ObHdmdi9X R0IyUEdBRHV2dWJOQVhPVUhRdk9FQ0F3RUEKQVFLQ0FnRUFsZk5rSVY5S3RpK2Ix bUUvZ3NXcm4rV250K2ZZbzBKWm5XMW5JK05hYm5CSHhFb3JUQy9rZytuRgo1YnE0 RDZRaktMeEEydzBTSW5aaExHb3NBT3NrSE5pVDkyV3puQ0hHQkJ3cmUzOEVxWG9C aC9aS01RTDJOUEhXClBETFM1bGJkQVB2NWx5TWhXV2Z3YnRKV210WEZ5bmFOTDQ1 aCtrTGJYZ1IrMHlLbjE0STJNNzFMaEVhREJGbnkKbUR0ZTdQUFJ6Zm96aWptQ3JD bzdQeWRXbi9DYWNZU29XdTZlaEorU015Q09EMmV5MHdHdEc3VTJhV2doTUg1Uwo4 L05hbXpKcURWZmp5UE5mUU1OVzdsY0ZwR1F2STd0VTAya3NMRnVHcGF0NjdFc3Yv UEh6Mm9rMENMaGRoMUtJCi9ZS01jdDViODBtdlZMM0dpaTM2d2J6WXltTWQwb0Rr UjdRdEdoYjZiZUs2d2ZaTTMyNmdsZ1QxMW5GUVZ6UnkKUTlvWmxVT3FIa0dEWE1Q MmhIeHJFY1VNa1MyNXBBOGlsUzQxRVlHbjdjbHZUL3NZZ1AzNnJzZmFOUU4rTHYx bgpmRHF4aTVkZUlFcEQxdHpGMkZqeldTTEFCUnpoRURrQjRkejN4WklZRjVnZWhw N0xtNE13ZnRrQ2kzOGdqaFJoCkQ0Zks3V3pBWFB1NzhFSk9RbjQ5dnk4ejdjbzZk Yk5mWk5BNjBZY3VycUlndk1CYWEwV0lab1pCYk5zK0hBdVcKRWI5dkhlNnN4OFVR TXowSVZWQlBBYUFvOTZRRnorUjlhL1IvSmRISVVxTUE2Umc4aFF3dFJZeUp3WWVI djRvNwpTNlJWeWpmVXlINUxVU2pPT2xwUlhnMnZrY0J1dmtYSWJaK2FWRHo4VVhu NjZNMVIwb0VDZ2dFQkFPN29OQlo1CjVpaVl6eGdsdDZCa1ZYSldHblJXL2xsOVVu YmE4ZVp0TmtWSVNDN09kN3pXbWs2cnU3ZE5SMDZna0lkaXB6aVMKRlNUQW95NWZ6 VDg3ekpremdSY1dqLzRwcDhHVUJrdFIya1JpaW40a3BCR2FSZUU2R3hJVnFhRmE2 RXdEMXg5LwpSVVE5Q3hTd0ErRG51U2hlRUVMbWRrUCtkOFpiM0hUeXJpcjgrd2lq RVBXbWhKelBrc1NCUS9GbWpjTXFRUDZKClJmeGtGUWErcWxSRG1Oc3JBTDZ6Nno4 MzQrQ215K3NteWNpdjJYeEtWVVlES0U3MlRoVm80SlhHLytObnRLZUMKUlRxWXp1 S3R0cHdJd1lTaXAxcHFqYUlaM25tUzJSeHdQNU5oQTlIejJla2VTTC9aaUdrSWxQ N25ZbVlCeXFxNgpFSSt5SFFQMm4raS9mdVVDZ2dFQkFPTk5PdktyZ0YvRkhpTmw4 Zll2d0JBVFJaNnplMXZMUlMwdTZMdmpWQkZmCmdSNmdtbDN1Z3hwNTBjaW5INEdP eUt2NGpicnMvVTFRR1IzYVJ5NE5Ca016Z09JVmVsaDArZk9UNlJNdlJJUWMKam9S VHdUdmJOZmlMSmlPbUlvRGRXT2FqOHZkeWFIaytvK1hpWXZjaVhsWitPbjRCVHk2 eFNtRUwzSWVQV0FxSgpmNjhtczhOSk1QYmkxbnI4N3EvR0FaRFdOSjY2Z1hMVWxG TUpwbU9WcUJIbVhLenJoQyt2eXY1dGllcW9JczFMCjRGSUZabDNBTjYwendDSXh2 eXhzK3dDbHV4cTZURlIvdzNzZmtuSzJsSTlFaitycnBEczlZV04ycWZnSDBKdDAK NDk5QnI3bm1SZlNmckVmc1kxVjJ4blRtQlhxc0VUMkNUSlJuSXlOdUtrMENnZ0VB YmRBMkFRN1BDR0lVN3hpSApLeVp6VURiYnVoWXltNWZMUys2ZnVqY0E5eCtlYmtW aExGL0lWZGtDVStNbG43S1dQR1RRVUdSMWE0dFFkb1I2CnAxSXBYVkliU0MyS3ls MERTeXRyS1R2YWhBeDNkRHdMWGp2M1d1dUdmZTJQSnlmT0Z3Szg0ekZ3K1VqRnl5 Q00KNTlnYmQ3Nms0dHRrQ1NUeWtTNndTdUV4eFhpN091RVpicEMzN0F4TmZoMmN5 VjFHVkNzYjdPUFVVNHI5VHpoYwp1cGJIc0JZNEpYQTE5YjBPOWJnMWkwVXRBeDR4 YmJ3TkxqMU5UZDVSVGU0RExWVm5VWFBkeWhGTEdRQWNPSDE0CnJvZ255M3VvU1Jz cE54V0UrWVRTWHd3SmJRanU1SmFkMTFXZ1F1OE9rSmp0UTYyL3dQdVoySmZsL09i MkIxaFoKY0haMU1RS0NBUUVBa1FVVUtBR2RyUHlocHVvQy94UW1FTnVLM3A4YWhF MWpQRm1pYVVXM3ZFSFhxb2ZERlV6NApYbXI4bW0xdUg0WE9xRkd6YzJDQ2w5SVR4 RVVnaHRRT2U4K2ZXaDlqNkkzeGJ5T2VYL3dYVmNhMmN0elErM1IzCnNiUnR4KzdX TXF1R2JkaUtTcSsyMGl4UiszaDl0Yms2d1NwVi9WQ3VpVmJaNHFManQ2V1FBV0VL a3VBNWJzNEMKckhHN2I4cHlLcmxGQkhoMktCTk1SY3cxT2VsOVBDb2VpaFVVYWNy MWtrc3hVelRsK2szOXJrZkx2ZWp1RDhCMApoVS93TktEU25QQ0hFRG1zNzNlTy9a WnFUT0t1MS90L093eitXVjZ3Y0k5UDFGckFSSndQenk4N3Q1UThIbm81CmhjSmQ4 NkZ4R3ZUbDEyMXViMzdhblFqRi9TVDBlVVZ2UFFLQ0FRQUtiNEYvb2ZxVTdMN2VT djRhZllXSGRIclEKNWIrcEl4TE1pYlk0TzJ4SVdIWldYZ0k3NWI2ajBBMC9Oay9s aVU5dzlVNUtCazEwVVhFMkl6Sy9yMXY5ZEhzYQpMTE1JQXpmK0FkY1NYSDNHdmRC R0FidGZIeFdVQTdSNWlUaHlVak9peWtyc1BDaXlVU2lCODhWU2NsbTFoNWtCCmlj QjFBYnFQNXNsdU9aN25qY1h4TW11Y0Q5MVRkQ1drWjZ5MHlMSU15eC85dm5pN1E5 RjArVXdsS1BhbURvNHAKUkNRemxtMmI2WVlKOEx4UWRrYmU0c3d5R0MzWUFCM0V5 VHVncVQzSk5aY3dDanZaZ0duUkR1SFVPU0NYaEtZLwpvVnlLQ1cyNlA5TDdZb0Vh Zm1Oa1pHbHJmZFJYVVNRdWwwbnRFeEtUOHFtMjFvMFpSelVQdEhCTi93QTYKLS0t LS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0K
ENV GIT_USERNAME binhqdgreenglobal
ENV WP_DBNAME gg
ENV WP_USER gg
ENV WP_PASS gg123456
ENV WP_HOST db
ENV WP_CACHEHOME /var/www/html/wp-content/plugins/wp-super-cache/

#RUN mkdir -p /root/.ssh \
#    && ssh-keyscan bitbucket.org >> /root/.ssh/known_hosts \
#    && ssh-keyscan github.com >> /root/.ssh/known_hosts


# Set the work directory
WORKDIR /var/www

COPY privatekey ./

#RUN rm -rf /var/www/tmp
#RUN chmod 400 privatekey && eval "$(ssh-agent -s)" && ssh-add privatekey && git clone -b develop git@bitbucket.org:toancauxanh/gg-web-live.git /var/www/tmp

#RUN rm -rf /var/www/html/*
#RUN cp -R tmp/* /var/www/html/


# COPY run.sh ./
COPY vhost.sample /etc/nginx/sites-enabled/default.conf
COPY cm_rules.nginx.sample /var/www/cm_rules.nginx

WORKDIR /var/www/html

EXPOSE 3000
